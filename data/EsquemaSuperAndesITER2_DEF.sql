create sequence SuperAndes_sequence;

CREATE TABLE A_CLIENTE
(IDENTIFICACION NUMBER NOT NULL,
	NOMBRE VARCHAR2 (255 BYTE) NOT NULL,
	CORREO VARCHAR2 (255 BYTE) NOT NULL,
	DIRECCION VARCHAR2 (255 BYTE),
	CONSTRAINT A_CLIENTE PRIMARY KEY (IDENTIFICACION)
);

CREATE TABLE A_FACTURA
( IDFACTURA NUMBER NOT NULL,
DESCRIPCION VARCHAR2(255 BYTE) NOT NULL,
CONSTRAINT A_FACTURA PRIMARY KEY (IDFACTURA)		
);

CREATE TABLE A_SUCURSAL
(IDSUCURSAL NUMBER NOT NULL,
	NOMBRE VARCHAR2 (255 BYTE) NOT NULL,
	CIUDAD VARCHAR2(255 BYTE) NOT NULL,
	DIRECCION VARCHAR2 (255 BYTE) NOT NULL,
	CONSTRAINT A_SUCURSAL PRIMARY KEY(IDSUCURSAL)
);


CREATE TABLE A_PROVEEDOR
( NIT NUMBER,
	NOMBRE VARCHAR2(255 BYTE) NOT NULL,
	CONSTRAINT A_PROVEEDOR_PK PRIMARY KEY (NIT)
);

ALTER TABLE A_PROVEEDOR
	ADD CONSTRAINT UN_PROVEEDOR_NOMBRE
	UNIQUE (NOMBRE)
ENABLE;	

CREATE TABLE A_PROMOCION
(IDPROMOCION NUMBER NOT NULL,
	TIPO NUMBER NOT NULL,
	N NUMBER NOT NULL,
	M NUMBER NOT NULL,
	FECHACADUCIDAD VARCHAR2(255 BYTE) NOT NULL,
	CONSTRAINT A_PROMOCION PRIMARY KEY(IDPROMOCION));
    
ALTER TABLE A_PROMOCION
	ADD CONSTRAINT CK_TIPO
	CHECK (TIPO IN (1,2,3,4))
ENABLE;
ALTER TABLE A_PROMOCION
	ADD CONSTRAINT CK_N
	CHECK (N>0)
ENABLE;
ALTER TABLE A_PROMOCION
	ADD CONSTRAINT CK_M
	CHECK (M>0)
ENABLE;


CREATE TABLE A_BODEGA 
(IDBODEGA NUMBER NOT NULL,
	TIPO VARCHAR2(255 BYTE) NOT NULL,
	PESO NUMBER NOT NULL,
	VOLUMEN NUMBER NOT NULL,
	SUCURSAL NUMBER NOT NULL,
	CONSTRAINT A_BODEGA PRIMARY KEY (IDBODEGA)

);

ALTER TABLE A_BODEGA
	ADD CONSTRAINT CK_PESO
	CHECK (PESO>0)
ENABLE;
ALTER TABLE A_BODEGA
    ADD CONSTRAINT CK_TIPOBODEGA
    CHECK (TIPO IN ('carne', 'galleta', 'fruta', 'tuberculo', 'escoba', 'balde', 'trapeador', 'brillador', 'cepillo', 'desodorante', 'crema', 'cera'))
ENABLE;
ALTER TABLE A_BODEGA
	ADD CONSTRAINT CK_VOLUMEN
	CHECK (VOLUMEN>0)
ENABLE;
ALTER TABLE A_BODEGA
    ADD CONSTRAINT FK_SUCURSAL
	FOREIGN KEY (SUCURSAL)
	REFERENCES A_SUCURSAL(IDSUCURSAL)
ENABLE;

CREATE TABLE A_ESTANTE
(IDESTANTE NUMBER NOT NULL,
	TIPO VARCHAR2(255 BYTE) NOT NULL,
	PESO NUMBER NOT NULL,
	VOLUMEN NUMBER NOT NULL,
	NIVELAPROVISIONAMIENTO NUMBER NOT NULL,
	SUCURSAL NUMBER NOT NULL,
	CONSTRAINT A_ESTANTE PRIMARY KEY(IDESTANTE)
);
ALTER TABLE A_ESTANTE
	ADD CONSTRAINT CK_PESOESTANTE
	CHECK ( PESO>0)
ENABLE;
ALTER TABLE A_ESTANTE
    ADD CONSTRAINT CK_TIPOESTANTE
    CHECK (TIPO IN ('carne', 'galleta', 'fruta', 'tuberculo', 'escoba', 'balde', 'trapeador', 'brillador', 'cepillo', 'desodorante', 'crema', 'cera'))
ENABLE;
ALTER TABLE A_ESTANTE
	ADD CONSTRAINT CK_VOLUMENESTANTE
	CHECK (VOLUMEN >0)
ENABLE;
ALTER TABLE A_ESTANTE
	ADD CONSTRAINT CK_NIVELAPROVISIONAMIENTO
	CHECK (NIVELAPROVISIONAMIENTO>0)
ENABLE;
ALTER TABLE A_ESTANTE
	ADD CONSTRAINT FK_SUCURSALESTANTE
	FOREIGN KEY (SUCURSAL)
	REFERENCES A_SUCURSAL(IDSUCURSAL)
ENABLE;


CREATE TABLE A_PRODUCTOSUCURSAL
( IDPRODUCTOSUCURSAL NUMBER NOT NULL,
	NOMBRE VARCHAR2(255 BYTE) NOT NULL,
	MARCA VARCHAR2(255 BYTE) NOT NULL,
	PRESENTACION VARCHAR2(255 BYTE) NOT NULL,
	CANTIDADPRESENTACION NUMBER NOT NULL,
	UNIDADMEDIDA VARCHAR2(255 BYTE) NOT NULL,
	VOLUMENEMPAQUE NUMBER NOT NULL,
	PESOEMPAQUE NUMBER NOT NULL,
	CODIGOBARRAS NUMBER NOT NULL,
	CATEGORIA VARCHAR2(255 BYTE) NOT NULL,
	TIPO VARCHAR2(255 BYTE) NOT NULL,
	FECHAVENCIMIENTO DATE NOT NULL,
	NIVELREORDEN NUMBER NOT NULL,
	PRECIOUNITARIO NUMBER NOT NULL,
	CANTIDADBODEGA NUMBER NOT NULL,
    CANTIDADESTANTE NUMBER NOT NULL,
	PRECIOUNIDADMEDIDA NUMBER NOT NULL,
	BODEGA NUMBER NOT NULL,
	ESTANTE NUMBER NOT NULL,
    PROMOCION NUMBER,
    CONSTRAINT A_PRODUCTOSUCURSAL PRIMARY KEY(IDPRODUCTOSUCURSAL)
);

ALTER TABLE A_PRODUCTOSUCURSAL
	ADD CONSTRAINT CK_CANTIDADPRESENTACION
	CHECK (CANTIDADPRESENTACION>0 )
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL
    ADD CONSTRAINT CK_TIPOPRODUCSUCUR
    CHECK (TIPO IN ('carne', 'galleta', 'fruta', 'tuberculo', 'escoba', 'balde', 'trapeador', 'brillador', 'cepillo', 'desodorante', 'crema', 'cera'))
ENABLE;
ALTER TABLE A_PRODUCTOSUCURSAL
    ADD CONSTRAINT CK_CATEPRODUCSUCUR
    CHECK (CATEGORIA IN ('perecedero', 'albarrote', 'aseo personal'))
ENABLE;
ALTER TABLE A_PRODUCTOSUCURSAL
	ADD CONSTRAINT CK_VOLUMENEMPAQUE
	CHECK (VOLUMENEMPAQUE>0)
ENABLE; 

ALTER TABLE A_PRODUCTOSUCURSAL
	ADD CONSTRAINT CK_PESOEMPAQUE
	CHECK (PESOEMPAQUE>0)
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL
	ADD CONSTRAINT CK_NIVELREORDEN
	CHECK (NIVELREORDEN>0)
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL    
	ADD CONSTRAINT CK_PRECIOUNITARIO
	CHECK (PRECIOUNITARIO>0)
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL    
	ADD CONSTRAINT CK_CANTIDADESTANTE
	CHECK (CANTIDADESTANTE>=0)
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL    
	ADD CONSTRAINT CK_CANTIDADBODEGA
	CHECK (CANTIDADBODEGA>=0)
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL    
	ADD CONSTRAINT CK_PRECIOUNIDADMEDIDA
	CHECK (PRECIOUNIDADMEDIDA>0)
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL    
	ADD CONSTRAINT FK_BODEGA
	FOREIGN KEY (BODEGA)
	REFERENCES A_BODEGA(IDBODEGA)
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL    
	ADD CONSTRAINT FK_PROMOCION
	FOREIGN KEY (PROMOCION)
	REFERENCES A_PROMOCION(IDPROMOCION)
ENABLE; 
ALTER TABLE A_PRODUCTOSUCURSAL    
	ADD CONSTRAINT FK_ESTANTE
	FOREIGN KEY (ESTANTE)
	REFERENCES A_ESTANTE(IDESTANTE)
ENABLE;

CREATE TABLE A_COMPRA
( IDCOMPRA NUMBER NOT NULL,
	FECHA DATE NOT NULL,
	CANTIDAD NUMBER NOT NULL,
    TOTALPAGADO NUMBER NOT NULL,
	PRODUCTOSUCURSAL NUMBER NOT NULL,
	CLIENTE NUMBER NOT NULL,
	FACTURA NUMBER NOT NULL,
	CONSTRAINT A_COMPRA PRIMARY KEY (IDCOMPRA)

);

ALTER TABLE A_COMPRA
	ADD CONSTRAINT CK_TOTALPAGADO
	CHECK(TOTALPAGADO>0)
ENABLE;

ALTER TABLE A_COMPRA
	ADD CONSTRAINT CK_CANTIDAD
	CHECK(CANTIDAD>0)
ENABLE;
ALTER TABLE A_COMPRA
	ADD CONSTRAINT FK_PRODUCTOSUCURSAL
	FOREIGN KEY (PRODUCTOSUCURSAL)
	REFERENCES A_PRODUCTOSUCURSAL(IDPRODUCTOSUCURSAL)
ENABLE;
ALTER TABLE A_COMPRA
	ADD CONSTRAINT FK_CLIENTE
	FOREIGN KEY (CLIENTE)
	REFERENCES A_CLIENTE(IDENTIFICACION)
ENABLE;
ALTER TABLE A_COMPRA
    ADD CONSTRAINT FK_FACTURA
	FOREIGN KEY (FACTURA)
	REFERENCES A_FACTURA(IDFACTURA)
ENABLE;

CREATE TABLE A_PRODUCTOPROVEEDOR
(IDPRODUCTOPROVEEDOR NUMBER NOT NULL,
	NOMBRE VARCHAR2(255 BYTE) NOT NULL,
	MARCA VARCHAR2(255 BYTE) NOT NULL,
	PRESENTACION VARCHAR2(255 BYTE) NOT NULL,
	CANTIDADPRESENTACION NUMBER NOT NULL,
	UNIDADMEDIDA VARCHAR2(255 BYTE) NOT NULL,
	VOLUMENEMPAQUE NUMBER NOT NULL,
	PESOEMPAQUE NUMBER NOT NULL,
	CODIGOBARRAS NUMBER NOT NULL,
	CATEGORIA VARCHAR2(255 BYTE) NOT NULL,
	TIPO VARCHAR2(255 BYTE) NOT NULL,
	FECHAVENCIMIENTO DATE NOT NULL, 
	CALIDAD NUMBER NOT NULL,
	PRECIO NUMBER NOT NULL,
	NUMEROCALIFICACIONES NUMBER NOT NULL,
	SUMACALIFICACIONES NUMBER NOT NULL,
	PROVEEDOR NUMBER NOT NULL,
	CONSTRAINT A_PRODUCTOPROVEEDOR PRIMARY KEY(IDPRODUCTOPROVEEDOR)
);

ALTER TABLE A_PRODUCTOPROVEEDOR
	ADD CONSTRAINT FK_PROVEEDORPRODUCTOPROVEEDOR
	FOREIGN KEY (PROVEEDOR)
	REFERENCES A_PROVEEDOR(NIT)
ENABLE;  

ALTER TABLE A_PRODUCTOPROVEEDOR
    ADD CONSTRAINT CK_TIPOPRODUCPROVEE
    CHECK (TIPO IN ('carne', 'galleta', 'fruta', 'tuberculo', 'escoba', 'balde', 'trapeador', 'brillador', 'cepillo', 'desodorante', 'crema', 'cera'))
ENABLE;

ALTER TABLE A_PRODUCTOPROVEEDOR
    ADD CONSTRAINT CK_CATEPRODUCPROVEE
    CHECK (CATEGORIA IN ('perecedero', 'albarrote', 'aseo personal'))
ENABLE;

ALTER TABLE A_PRODUCTOPROVEEDOR
   ADD CONSTRAINT CK_PRODUCPROVEVOLEMPAQUE
   CHECK (VOLUMENEMPAQUE>0)
   ENABLE;
   
ALTER TABLE A_PRODUCTOPROVEEDOR
   ADD CONSTRAINT CK_PRODUCPROVEPESOEMPAQUE
   CHECK (PESOEMPAQUE>0)
   ENABLE;
   
ALTER TABLE A_PRODUCTOPROVEEDOR
   ADD CONSTRAINT CK_PRODUCTOPROVEEDORCALIDAD
   CHECK (CALIDAD IN (0,1,2,3,4,5))
   ENABLE;
   
ALTER TABLE A_PRODUCTOPROVEEDOR
	ADD CONSTRAINT CK_PRECIOPRODUCTOPROVEEDOR
	CHECK (PRECIO>0)
   ENABLE;   

ALTER TABLE A_PRODUCTOPROVEEDOR 
	ADD CONSTRAINT CK_NUMEROCALIFICACIONES
	CHECK (NUMEROCALIFICACIONES>=0)
ENABLE;   

ALTER TABLE A_PRODUCTOPROVEEDOR

	ADD CONSTRAINT CK_SUMACALIFICACIONES
	CHECK (SUMACALIFICACIONES>=0)
 ENABLE;   

ALTER TABLE A_PRODUCTOPROVEEDOR
	ADD CONSTRAINT CK_CANTIDAPRESENTACION
	CHECK ( CANTIDADPRESENTACION>0)

ENABLE;

CREATE TABLE A_ORDENPEDIDO
(IDORDENPEDIDO NUMBER NOT NULL,
	PRECIO NUMBER NOT NULL,
	FECHAENTREGA DATE,
	FECHAESPERADAENTREGA DATE NOT NULL,
	CALIFICACION NUMBER,
	ENTREGADO NUMBER NOT NULL,
	CANTIDAD NUMBER NOT NULL,
	PRODUCTOPROVEEDOR NUMBER NOT NULL,
	SUCURSAL NUMBER NOT NULL,
	CONSTRAINT A_ORDENPEDIDO PRIMARY KEY (IDORDENPEDIDO)

);

ALTER TABLE A_ORDENPEDIDO
	ADD CONSTRAINT CK_PRECIO
	CHECK ( PRECIO>0)
ENABLE;
ALTER TABLE A_ORDENPEDIDO
	ADD CONSTRAINT CK_CALIFICACION
	CHECK (CALIFICACION IN (0,1,2,3,4,5))
ENABLE;
ALTER TABLE A_ORDENPEDIDO
    ADD CONSTRAINT CK_ENTEGADOPEDIDO
    CHECK (ENTREGADO IN (0,1))
ENABLE;
ALTER TABLE A_ORDENPEDIDO    
	ADD CONSTRAINT CK_CANTIDADORDEN
	CHECK (CANTIDAD>0)
ENABLE;
ALTER TABLE A_ORDENPEDIDO    
	ADD CONSTRAINT FK_PRODUCTOPROVEEDOR
	FOREIGN KEY (PRODUCTOPROVEEDOR)
	REFERENCES A_PRODUCTOPROVEEDOR(IDPRODUCTOPROVEEDOR)
ENABLE;
ALTER TABLE A_ORDENPEDIDO    
	ADD CONSTRAINT FK_SUCURSALORDEN
	FOREIGN KEY (SUCURSAL)
	REFERENCES A_SUCURSAL(IDSUCURSAL)
ENABLE;

CREATE TABLE A_CARRITO
(IDCARRITO NUMBER NOT NULL,
 OCUPADO NUMBER NOT NULL,
 CONSTRAINT A_CARRITO_PK PRIMARY KEY (IDCARRITO)
);
ALTER TABLE A_CARRITO
    ADD CONSTRAINT CK_OCUPADOCARRITO
    CHECK (OCUPADO IN (-1,0,1))
ENABLE;

CREATE TABLE A_DENTROCARRITO
(IDCARRITO NUMBER NOT NULL,
 IDPRODUCTOSUCURSAL NUMBER NOT NULL,
 CANTIDAD NUMBER NOT NULL,
 CONSTRAINT A_DENTROCARRITO_PK PRIMARY KEY (IDCARRITO, IDPRODUCTOSUCURSAL)
 );
